<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - Sistema de Cardápio</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='login.css') }}">
<body data-theme="light">
  <!-- Partículas -->
  <div class="particles" id="particles"></div>

  <div class="glow-container">
    <div class="container">
      <form class="form">
        <div id="login-area">
          <p>LOGIN</p>
          <p id="sicro">Faça login com sua conta Google</p>
        </div>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-messages">
            {% for category, message in messages %}
              <div class="flash {{ category }}">
                <i class="fas fa-{% if category == 'success' %}check-circle{% elif category == 'danger' %}exclamation-circle{% elif category == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
        {% endwith %}

        <div class="social-buttons-container">
          <a href="{{ url_for('main.login_google') }}" class="social-login-btn">
            <i class="fab fa-google"></i> Continuar com Google
          </a>
        </div>
      </form>
    </div>
  </div>

  <button class="theme-toggle" id="themeToggle">🌙</button>

<script>
const themeToggle = document.getElementById('themeToggle');
const body = document.body;
const savedTheme = localStorage.getItem('theme');
if(savedTheme) { body.setAttribute('data-theme', savedTheme); updateThemeButton(savedTheme); }

themeToggle.addEventListener('click', () => {
  const currentTheme = body.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
  body.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  updateThemeButton(newTheme);
  createParticles();
});
function updateThemeButton(theme){ themeToggle.textContent = theme==='dark'? '☀️':'🌙'; }

// Ripple
document.querySelectorAll('button, .social-login-btn').forEach(button => {
  button.addEventListener('click', function(e){
    const ripple = document.createElement('span');
    ripple.classList.add('ripple-effect'); this.appendChild(ripple);
    const x = e.clientX - this.getBoundingClientRect().left;
    const y = e.clientY - this.getBoundingClientRect().top;
    ripple.style.left=`${x}px`; ripple.style.top=`${y}px`;
    setTimeout(()=>ripple.remove(),600);
  });
});

// Flash auto-remove
setTimeout(()=>{ document.querySelectorAll('.flash').forEach(msg=>{ msg.style.opacity='0'; setTimeout(()=>msg.remove(),600); }); },5000);

// Partículas
function createParticles(){
  const particlesContainer = document.getElementById('particles');
  particlesContainer.innerHTML='';
  const particleCount = 30;
  const colors = body.getAttribute('data-theme')==='dark'?['#dc2626','#ef4444','#991b1b','#7f1d1d']:['#ff6b35','#ff8e53','#00c897','#00e3ae'];
  for(let i=0;i<particleCount;i++){
    const particle=document.createElement('div');
    particle.classList.add('particle');
    const size=Math.random()*20+5;
    particle.style.width=`${size}px`;
    particle.style.height=`${size}px`;
    particle.style.left=`${Math.random()*100}%`;
    particle.style.top=`${Math.random()*100}%`;
    particle.style.background=colors[Math.floor(Math.random()*colors.length)];
    const duration=Math.random()*20+15;
    const delay=Math.random()*5;
    particle.style.animationDuration=`${duration}s`;
    particle.style.animationDelay=`${delay}s`;
    particlesContainer.appendChild(particle);
  }
}
createParticles();
</script>
</body>
</html>
