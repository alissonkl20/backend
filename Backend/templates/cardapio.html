<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardápio Organizado</title>
    <meta name="color-scheme" content="light dark">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='cardapio.css') }}">
</head>
<body data-theme="light">
    <!-- Barra de navegação -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('main.dashboard') }}">
                <i class="fas fa-bread-slice"></i> Sistema Padaria
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">
                    <i class="fas fa-user"></i> Olá, {{ usuario.nome }}
                </span>
                <a class="btn btn-outline-light btn-sm" href="{{ url_for('main.logout') }}">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="cardapio-container">
            <h1><i class="fas fa-utensils"></i> Cardápio Organizado</h1>
            <p class="update-time">Atualizado em: <span>{{ dados.atualizado_em }}</span></p>

            {% if dados.erro %}
            <div class="erro">
                <i class="fas fa-exclamation-circle"></i> {{ dados.erro }}
            </div>
            {% else %}
            {% for cat, produtos in dados.categorias.items() %}
            <div class="categoria">
                <h2 class="categoria-titulo">
                    <i class="fas fa-{% if 'bebida' in cat|lower or 'suco' in cat|lower or 'refrigerante' in cat|lower %}glass-martini-alt{% elif 'sobremesa' in cat|lower or 'doce' in cat|lower or 'bolo' in cat|lower %}ice-cream{% elif 'salgado' in cat|lower or 'salgadinho' in cat|lower %}drumstick-bite{% elif 'pao' in cat|lower or 'pão' in cat|lower or 'bread' in cat|lower %}bread-slice{% elif 'cafe' in cat|lower or 'café' in cat|lower or 'coffee' in cat|lower %}coffee{% elif 'lanche' in cat|lower or 'sanduiche' in cat|lower %}hamburger{% elif 'torta' in cat|lower or 'pie' in cat|lower %}chart-pie{% else %}folder{% endif %}"></i> 
                    {{ cat }}
                    <span class="contador-categoria">{{ produtos.disponiveis|length + produtos.indisponiveis|length }}</span>
                </h2>

                <h3 class="status-titulo">
                    <i class="fas fa-check-circle"></i> Disponíveis
                    <span class="contador-status">{{ produtos.disponiveis|length }}</span>
                </h3>
                <div class="produtos-grid">
                    {% if produtos.disponiveis %}
                    {% for p in produtos.disponiveis %}
                    <div class="produto-card">
                        <span class="produto-nome">{{ p.nome }}</span>
                        <span class="produto-preco">R$ {{ "%.2f"|format(p.preco) }}</span>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="sem-produtos">Nenhum {{ cat|lower }} disponível</div>
                    {% endif %}
                </div>

                <h3 class="status-titulo indisponivel">
                    <i class="fas fa-times-circle"></i> Indisponíveis
                    <span class="contador-status">{{ produtos.indisponiveis|length }}</span>
                </h3>
                <div class="produtos-grid">
                    {% if produtos.indisponiveis %}
                    {% for p in produtos.indisponiveis %}
                    <div class="produto-card">
                        <span class="produto-nome">{{ p.nome }}</span>
                        <span class="produto-preco">R$ {{ "%.2f"|format(p.preco) }}</span>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="sem-produtos">Nenhum {{ cat|lower }} indisponível</div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}

            <p class="total-produtos"><i class="fas fa-clipboard-list"></i> Total de produtos: {{ dados.total_produtos }}</p>
            {% endif %}
        </div>
    </div>

    <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <script>
        // O restante do seu script permanece igual
        const themeToggle = document.getElementById('themeToggle');
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
        const currentTheme = localStorage.getItem('theme') || (prefersDarkScheme.matches ? 'dark' : 'light');
        document.body.setAttribute('data-theme', currentTheme);
        updateThemeIcon(currentTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.body.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
            
            themeToggle.style.transform = 'scale(0.9)';
            setTimeout(() => themeToggle.style.transform = 'scale(1)', 100);
            
            const ripple = document.createElement('span');
            ripple.classList.add('ripple-effect');
            themeToggle.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);
        });

        function updateThemeIcon(theme) {
            const icon = themeToggle.querySelector('i');
            icon.className = theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
        }

        prefersDarkScheme.addEventListener('change', e => {
            if (!localStorage.getItem('theme')) {
                const newTheme = e.matches ? 'dark' : 'light';
                document.body.setAttribute('data-theme', newTheme);
                updateThemeIcon(newTheme);
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const categorias = document.querySelectorAll('.categoria');
            categorias.forEach((categoria, index) => {
                categoria.style.animationDelay = `${0.1 + (index * 0.1)}s`;
            });
        });
    </script>
</body>
</html>